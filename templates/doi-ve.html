{% extends "layout/base.html" %}
{% block content %}
<div class="main">
  <div class="container">
    <ul class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/info-ve">Vé</a></li>
        <li class="active">Đổi Vé</li>
    </ul>
    <!-- BEGIN SIDEBAR & CONTENT -->
    <div class="row margin-bottom-40">
      <!-- BEGIN SIDEBAR -->
      <div class="sidebar col-md-3 col-sm-5">
      <!-- {% if current_user.VaiTro == "N" %}
        <ul class="list-group margin-bottom-25 sidebar-menu">
          <li class="list-group-item clearfix"><a href="/list-ve"><i class="fa fa-angle-right"></i> Danh sách vé</a></li>
          <li class="list-group-item clearfix"><a href="/list-khach"><i class="fa fa-angle-right"></i> Danh sách khách hàng</a></li>
          <li class="list-group-item clearfix"><a href="/"><i class="fa fa-angle-right"></i> Danh sách chuyến bay</a></li>
        </ul>
      {% elif current_user.VaiTro == "K" %}
      <ul class="list-group margin-bottom-25 sidebar-menu">
        <li class="list-group-item clearfix"><a href="/"><i class="fa fa-angle-right"></i> Tra Cứu Chuyến Bay</a></li>
      </ul>
      {% endif %} -->
      <ul class="list-group margin-bottom-25 sidebar-menu">
        <li class="list-group-item clearfix"><a href="/"><i class="fa fa-angle-right"></i> Tra Cứu Chuyến Bay</a></li>
      </ul>
      </div>
      
      <!-- END SIDEBAR -->

      <!-- BEGIN CONTENT -->
      <div class="col-md-9 col-sm-7">
        <h1>Đổi Trả Vé</h1>
        <div class="content-form-page">
            <div class="input-group">
              <input type="text" id="ve" name="ve" placeholder="Nhập mã vé" class="form-control">
              <span class="input-group-btn">
                <button class="btn btn-primary" onclick="check(0)">Đổi</button>
                <button class="btn btn-primary" onclick="check(1)">Trả</button>
              </span>
            </div>
        <div id="doi-ve"></div>
        </div>
      </div>
      <!-- END CONTENT -->
    </div>
    <!-- END SIDEBAR & CONTENT -->
  </div>
</div>
<script>
  function check(action){
    //var ve = document.getElementById('ve').innerHTML;
    var ve = $('#ve').val();
    checkVe(ve, action);
  }
</script>
<script>
   function checkVe(ve, action) {
    fetch("/api/check-ve/"+ve, {
        method: "post"
    }).then(function(res) {
        return res.json()
    }).then(function(data) {
        if (data.error_code == 404)
            alert("Vé đã quá thời gian trả không tồn tại hoặc đã quá thời gian đổi trả!")
        else
        {
            if (action==0)
            {
              $("doi-ve").append(<form role="form" class="form-horizontal form-without-legend">
            
            <div class="form-group">
              <label class="col-md-2 control-label">Hạng Vé<span class="require">*</span></label>
              <div class="col-md-8">
                <select class="form-control" required>
                  <option>--- Chọn Một Hạng Vé ---</option>
                  <option>Option 1</option>
                  <option>Option 2</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label class="col-md-2 control-label">Sân Bay Đi: <span class="require">*</span></label>
              <div class="col-md-8">
                <select class="form-control" required>
                  <option>--- Chọn một sân bay ---</option>
                  <option>Option 1</option>
                  <option>Option 2</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label class="col-md-2 control-label">Sân Bay Đến: <span class="require">*</span></label>
              <div class="col-md-8">
                <select class="form-control" required>
                  <option>--- Chọn một sân bay ---</option>
                  <option>Option 1</option>
                  <option>Option 2</option>
                </select>
              </div>
            </div>
            
            <div class="form-group">
              <label class="col-lg-2 control-label" for="email">Thời Gian Xuất Phát: </label>
              <div class="col-lg-8">
                <input type="datetime-local" id="tgxuatphat" name = "tgxuatphat" class="form-control" disabled>
              </div>
            </div>
            <div class="form-group">
              <label class="col-lg-2 control-label">Thời Gian Bay: </label>
              <div class="col-lg-8">
                <input type="number" id="tgbay" name="tgbay" class="form-control" disabled>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-8 col-md-offset-2 padding-left-0 padding-top-20">
                <button class="btn btn-primary" type="submit">Xác Nhận</button>
                <button type="reset" class="btn btn-default">Nhập Lại</button>
              </div>
            </div>
          </form>)
            } 
            else
                deleteVe(ve)
        }
    })
}
</script>

{% endblock %}
